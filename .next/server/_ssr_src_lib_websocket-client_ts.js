"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_src_lib_websocket-client_ts";
exports.ids = ["_ssr_src_lib_websocket-client_ts"];
exports.modules = {

/***/ "(ssr)/./src/lib/websocket-client.ts":
/*!*************************************!*\
  !*** ./src/lib/websocket-client.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WorkflowWebSocketClient: () => (/* binding */ WorkflowWebSocketClient)\n/* harmony export */ });\nclass WorkflowWebSocketClient {\n    constructor(options){\n        this.ws = null;\n        this.reconnectAttempts = 0;\n        this.reconnectTimer = null;\n        this.pingTimer = null;\n        this.isConnecting = false;\n        this.shouldReconnect = true;\n        this.options = {\n            reconnectInterval: 5000,\n            maxReconnectAttempts: 10,\n            ...options\n        };\n    }\n    connect() {\n        return new Promise((resolve, reject)=>{\n            if (this.isConnecting || this.ws && this.ws.readyState === WebSocket.OPEN) {\n                resolve();\n                return;\n            }\n            this.isConnecting = true;\n            try {\n                const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n                const wsUrl = `${protocol}//${window.location.host}/api/workflows/ws?workflowId=${this.options.workflowId}&token=${this.options.token}`;\n                this.ws = new WebSocket(wsUrl);\n                this.ws.onopen = ()=>{\n                    logger.info(\"WebSocket connected\", {\n                        workflowId: this.options.workflowId,\n                        component: \"websocket-client\"\n                    });\n                    this.isConnecting = false;\n                    this.reconnectAttempts = 0;\n                    this.startPingTimer();\n                    this.options.onConnect?.();\n                    resolve();\n                };\n                this.ws.onmessage = (event)=>{\n                    try {\n                        const message = JSON.parse(event.data);\n                        this.handleMessage(message);\n                    } catch (error) {\n                        console.error(\"Error parsing WebSocket message:\", error);\n                    }\n                };\n                this.ws.onclose = (event)=>{\n                    logger.info(\"WebSocket closed\", {\n                        code: event.code,\n                        reason: event.reason,\n                        workflowId: this.options.workflowId,\n                        component: \"websocket-client\"\n                    });\n                    this.isConnecting = false;\n                    this.stopPingTimer();\n                    this.options.onDisconnect?.();\n                    if (this.shouldReconnect && this.reconnectAttempts < this.options.maxReconnectAttempts) {\n                        this.scheduleReconnect();\n                    }\n                };\n                this.ws.onerror = (error)=>{\n                    console.error(\"WebSocket error:\", error);\n                    this.isConnecting = false;\n                    this.options.onError?.(error);\n                    if (this.ws?.readyState === WebSocket.CONNECTING) {\n                        reject(new Error(\"Failed to connect to WebSocket\"));\n                    }\n                };\n            } catch (error) {\n                this.isConnecting = false;\n                reject(error);\n            }\n        });\n    }\n    disconnect() {\n        this.shouldReconnect = false;\n        this.stopPingTimer();\n        this.clearReconnectTimer();\n        if (this.ws) {\n            this.ws.close(1000, \"Client disconnect\");\n            this.ws = null;\n        }\n    }\n    sendMessage(message) {\n        if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n            this.ws.send(JSON.stringify(message));\n        } else {\n            console.warn(\"WebSocket not connected, cannot send message:\", message);\n        }\n    }\n    sendUserResponse(agentId, response) {\n        this.sendMessage({\n            type: \"user_response\",\n            agentId,\n            response\n        });\n    }\n    sendWorkflowControl(action) {\n        this.sendMessage({\n            type: \"workflow_control\",\n            action\n        });\n    }\n    requestStatus() {\n        this.sendMessage({\n            type: \"request_status\"\n        });\n    }\n    handleMessage(message) {\n        // Handle pong messages\n        if (message.type === \"pong\") {\n            return;\n        }\n        this.options.onMessage?.(message);\n    }\n    startPingTimer() {\n        this.stopPingTimer();\n        this.pingTimer = setInterval(()=>{\n            this.sendMessage({\n                type: \"ping\"\n            });\n        }, 30000) // Ping every 30 seconds\n        ;\n    }\n    stopPingTimer() {\n        if (this.pingTimer) {\n            clearInterval(this.pingTimer);\n            this.pingTimer = null;\n        }\n    }\n    scheduleReconnect() {\n        this.clearReconnectTimer();\n        this.reconnectAttempts++;\n        const delay = Math.min(this.options.reconnectInterval * Math.pow(2, this.reconnectAttempts - 1), 30000 // Max 30 seconds\n        );\n        logger.info(\"Scheduling WebSocket reconnect\", {\n            attempt: this.reconnectAttempts,\n            delayMs: delay,\n            workflowId: this.options.workflowId,\n            component: \"websocket-client\"\n        });\n        this.reconnectTimer = setTimeout(()=>{\n            if (this.shouldReconnect) {\n                this.connect().catch((error)=>{\n                    console.error(\"Reconnect failed:\", error);\n                });\n            }\n        }, delay);\n    }\n    clearReconnectTimer() {\n        if (this.reconnectTimer) {\n            clearTimeout(this.reconnectTimer);\n            this.reconnectTimer = null;\n        }\n    }\n    get isConnected() {\n        return this.ws?.readyState === WebSocket.OPEN;\n    }\n    get connectionState() {\n        if (!this.ws) return \"disconnected\";\n        switch(this.ws.readyState){\n            case WebSocket.CONNECTING:\n                return \"connecting\";\n            case WebSocket.OPEN:\n                return \"connected\";\n            case WebSocket.CLOSING:\n                return \"closing\";\n            case WebSocket.CLOSED:\n                return \"disconnected\";\n            default:\n                return \"unknown\";\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVBLElBQUl1RSxjQUF1QjtRQUN6QixPQUFPLElBQUksQ0FBQ3pFLEVBQUUsRUFBRVksZUFBZUMsVUFBVUMsSUFBSTtJQUMvQztJQUVBLElBQUk0RCxrQkFBMEI7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQzFFLEVBQUUsRUFBRSxPQUFPO1FBRXJCLE9BQVEsSUFBSSxDQUFDQSxFQUFFLENBQUNZLFVBQVU7WUFDeEIsS0FBS0MsVUFBVWdDLFVBQVU7Z0JBQUUsT0FBTztZQUNsQyxLQUFLaEMsVUFBVUMsSUFBSTtnQkFBRSxPQUFPO1lBQzVCLEtBQUtELFVBQVU4RCxPQUFPO2dCQUFFLE9BQU87WUFDL0IsS0FBSzlELFVBQVUrRCxNQUFNO2dCQUFFLE9BQU87WUFDOUI7Z0JBQVMsT0FBTztRQUNsQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbnRlbGxpZ2VudC1iaWRkaW5nLXN5c3RlbS8uL3NyYy9saWIvd2Vic29ja2V0LWNsaWVudC50cz82M2VkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFdlYlNvY2tldE1lc3NhZ2UgfSBmcm9tICcuL3dlYnNvY2tldC1zZXJ2ZXInXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0Q2xpZW50T3B0aW9ucyB7XG4gIHdvcmtmbG93SWQ6IHN0cmluZ1xuICB0b2tlbjogc3RyaW5nXG4gIG9uTWVzc2FnZT86IChtZXNzYWdlOiBXZWJTb2NrZXRNZXNzYWdlKSA9PiB2b2lkXG4gIG9uQ29ubmVjdD86ICgpID0+IHZvaWRcbiAgb25EaXNjb25uZWN0PzogKCkgPT4gdm9pZFxuICBvbkVycm9yPzogKGVycm9yOiBFdmVudCkgPT4gdm9pZFxuICByZWNvbm5lY3RJbnRlcnZhbD86IG51bWJlclxuICBtYXhSZWNvbm5lY3RBdHRlbXB0cz86IG51bWJlclxufVxuXG5leHBvcnQgY2xhc3MgV29ya2Zsb3dXZWJTb2NrZXRDbGllbnQge1xuICBwcml2YXRlIHdzOiBXZWJTb2NrZXQgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIG9wdGlvbnM6IFdlYlNvY2tldENsaWVudE9wdGlvbnNcbiAgcHJpdmF0ZSByZWNvbm5lY3RBdHRlbXB0cyA9IDBcbiAgcHJpdmF0ZSByZWNvbm5lY3RUaW1lcjogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIHBpbmdUaW1lcjogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIGlzQ29ubmVjdGluZyA9IGZhbHNlXG4gIHByaXZhdGUgc2hvdWxkUmVjb25uZWN0ID0gdHJ1ZVxuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFdlYlNvY2tldENsaWVudE9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICByZWNvbm5lY3RJbnRlcnZhbDogNTAwMCxcbiAgICAgIG1heFJlY29ubmVjdEF0dGVtcHRzOiAxMCxcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9XG4gIH1cblxuICBjb25uZWN0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAodGhpcy5pc0Nvbm5lY3RpbmcgfHwgKHRoaXMud3MgJiYgdGhpcy53cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikpIHtcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IHRydWVcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonID8gJ3dzczonIDogJ3dzOidcbiAgICAgICAgY29uc3Qgd3NVcmwgPSBgJHtwcm90b2NvbH0vLyR7d2luZG93LmxvY2F0aW9uLmhvc3R9L2FwaS93b3JrZmxvd3Mvd3M/d29ya2Zsb3dJZD0ke3RoaXMub3B0aW9ucy53b3JrZmxvd0lkfSZ0b2tlbj0ke3RoaXMub3B0aW9ucy50b2tlbn1gXG4gICAgICAgIFxuICAgICAgICB0aGlzLndzID0gbmV3IFdlYlNvY2tldCh3c1VybClcblxuICAgICAgICB0aGlzLndzLm9ub3BlbiA9ICgpID0+IHtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnV2ViU29ja2V0IGNvbm5lY3RlZCcsIHsgXG4gICAgICAgICAgICB3b3JrZmxvd0lkOiB0aGlzLm9wdGlvbnMud29ya2Zsb3dJZCxcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3dlYnNvY2tldC1jbGllbnQnXG4gICAgICAgICAgfSlcbiAgICAgICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IGZhbHNlXG4gICAgICAgICAgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA9IDBcbiAgICAgICAgICB0aGlzLnN0YXJ0UGluZ1RpbWVyKClcbiAgICAgICAgICB0aGlzLm9wdGlvbnMub25Db25uZWN0Py4oKVxuICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy53cy5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkgYXMgV2ViU29ja2V0TWVzc2FnZVxuICAgICAgICAgICAgdGhpcy5oYW5kbGVNZXNzYWdlKG1lc3NhZ2UpXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgV2ViU29ja2V0IG1lc3NhZ2U6JywgZXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy53cy5vbmNsb3NlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oJ1dlYlNvY2tldCBjbG9zZWQnLCB7IFxuICAgICAgICAgICAgY29kZTogZXZlbnQuY29kZSxcbiAgICAgICAgICAgIHJlYXNvbjogZXZlbnQucmVhc29uLFxuICAgICAgICAgICAgd29ya2Zsb3dJZDogdGhpcy5vcHRpb25zLndvcmtmbG93SWQsXG4gICAgICAgICAgICBjb21wb25lbnQ6ICd3ZWJzb2NrZXQtY2xpZW50J1xuICAgICAgICAgIH0pXG4gICAgICAgICAgdGhpcy5pc0Nvbm5lY3RpbmcgPSBmYWxzZVxuICAgICAgICAgIHRoaXMuc3RvcFBpbmdUaW1lcigpXG4gICAgICAgICAgdGhpcy5vcHRpb25zLm9uRGlzY29ubmVjdD8uKClcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodGhpcy5zaG91bGRSZWNvbm5lY3QgJiYgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA8IHRoaXMub3B0aW9ucy5tYXhSZWNvbm5lY3RBdHRlbXB0cyEpIHtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVSZWNvbm5lY3QoKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMud3Mub25lcnJvciA9IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldCBlcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IGZhbHNlXG4gICAgICAgICAgdGhpcy5vcHRpb25zLm9uRXJyb3I/LihlcnJvcilcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodGhpcy53cz8ucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRvIFdlYlNvY2tldCcpKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IGZhbHNlXG4gICAgICAgIHJlamVjdChlcnJvcilcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLnNob3VsZFJlY29ubmVjdCA9IGZhbHNlXG4gICAgdGhpcy5zdG9wUGluZ1RpbWVyKClcbiAgICB0aGlzLmNsZWFyUmVjb25uZWN0VGltZXIoKVxuICAgIFxuICAgIGlmICh0aGlzLndzKSB7XG4gICAgICB0aGlzLndzLmNsb3NlKDEwMDAsICdDbGllbnQgZGlzY29ubmVjdCcpXG4gICAgICB0aGlzLndzID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIHNlbmRNZXNzYWdlKG1lc3NhZ2U6IGFueSkge1xuICAgIGlmICh0aGlzLndzICYmIHRoaXMud3MucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICAgIHRoaXMud3Muc2VuZChKU09OLnN0cmluZ2lmeShtZXNzYWdlKSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKCdXZWJTb2NrZXQgbm90IGNvbm5lY3RlZCwgY2Fubm90IHNlbmQgbWVzc2FnZTonLCBtZXNzYWdlKVxuICAgIH1cbiAgfVxuXG4gIHNlbmRVc2VyUmVzcG9uc2UoYWdlbnRJZDogc3RyaW5nLCByZXNwb25zZTogc3RyaW5nKSB7XG4gICAgdGhpcy5zZW5kTWVzc2FnZSh7XG4gICAgICB0eXBlOiAndXNlcl9yZXNwb25zZScsXG4gICAgICBhZ2VudElkLFxuICAgICAgcmVzcG9uc2VcbiAgICB9KVxuICB9XG5cbiAgc2VuZFdvcmtmbG93Q29udHJvbChhY3Rpb246ICdwYXVzZScgfCAncmVzdW1lJyB8ICdjYW5jZWwnKSB7XG4gICAgdGhpcy5zZW5kTWVzc2FnZSh7XG4gICAgICB0eXBlOiAnd29ya2Zsb3dfY29udHJvbCcsXG4gICAgICBhY3Rpb25cbiAgICB9KVxuICB9XG5cbiAgcmVxdWVzdFN0YXR1cygpIHtcbiAgICB0aGlzLnNlbmRNZXNzYWdlKHtcbiAgICAgIHR5cGU6ICdyZXF1ZXN0X3N0YXR1cydcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVNZXNzYWdlKG1lc3NhZ2U6IFdlYlNvY2tldE1lc3NhZ2UpIHtcbiAgICAvLyBIYW5kbGUgcG9uZyBtZXNzYWdlc1xuICAgIGlmICgobWVzc2FnZSBhcyBhbnkpLnR5cGUgPT09ICdwb25nJykge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5vcHRpb25zLm9uTWVzc2FnZT8uKG1lc3NhZ2UpXG4gIH1cblxuICBwcml2YXRlIHN0YXJ0UGluZ1RpbWVyKCkge1xuICAgIHRoaXMuc3RvcFBpbmdUaW1lcigpXG4gICAgdGhpcy5waW5nVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLnNlbmRNZXNzYWdlKHsgdHlwZTogJ3BpbmcnIH0pXG4gICAgfSwgMzAwMDApIC8vIFBpbmcgZXZlcnkgMzAgc2Vjb25kc1xuICB9XG5cbiAgcHJpdmF0ZSBzdG9wUGluZ1RpbWVyKCkge1xuICAgIGlmICh0aGlzLnBpbmdUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBpbmdUaW1lcilcbiAgICAgIHRoaXMucGluZ1RpbWVyID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2NoZWR1bGVSZWNvbm5lY3QoKSB7XG4gICAgdGhpcy5jbGVhclJlY29ubmVjdFRpbWVyKClcbiAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzKytcbiAgICBcbiAgICBjb25zdCBkZWxheSA9IE1hdGgubWluKFxuICAgICAgdGhpcy5vcHRpb25zLnJlY29ubmVjdEludGVydmFsISAqIE1hdGgucG93KDIsIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgLSAxKSxcbiAgICAgIDMwMDAwIC8vIE1heCAzMCBzZWNvbmRzXG4gICAgKVxuXG4gICAgbG9nZ2VyLmluZm8oJ1NjaGVkdWxpbmcgV2ViU29ja2V0IHJlY29ubmVjdCcsIHsgXG4gICAgICBhdHRlbXB0OiB0aGlzLnJlY29ubmVjdEF0dGVtcHRzLFxuICAgICAgZGVsYXlNczogZGVsYXksXG4gICAgICB3b3JrZmxvd0lkOiB0aGlzLm9wdGlvbnMud29ya2Zsb3dJZCxcbiAgICAgIGNvbXBvbmVudDogJ3dlYnNvY2tldC1jbGllbnQnXG4gICAgfSlcbiAgICBcbiAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zaG91bGRSZWNvbm5lY3QpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0KCkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlY29ubmVjdCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSwgZGVsYXkpXG4gIH1cblxuICBwcml2YXRlIGNsZWFyUmVjb25uZWN0VGltZXIoKSB7XG4gICAgaWYgKHRoaXMucmVjb25uZWN0VGltZXIpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlY29ubmVjdFRpbWVyKVxuICAgICAgdGhpcy5yZWNvbm5lY3RUaW1lciA9IG51bGxcbiAgICB9XG4gIH1cblxuICBnZXQgaXNDb25uZWN0ZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMud3M/LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOXG4gIH1cblxuICBnZXQgY29ubmVjdGlvblN0YXRlKCk6IHN0cmluZyB7XG4gICAgaWYgKCF0aGlzLndzKSByZXR1cm4gJ2Rpc2Nvbm5lY3RlZCdcbiAgICBcbiAgICBzd2l0Y2ggKHRoaXMud3MucmVhZHlTdGF0ZSkge1xuICAgICAgY2FzZSBXZWJTb2NrZXQuQ09OTkVDVElORzogcmV0dXJuICdjb25uZWN0aW5nJ1xuICAgICAgY2FzZSBXZWJTb2NrZXQuT1BFTjogcmV0dXJuICdjb25uZWN0ZWQnXG4gICAgICBjYXNlIFdlYlNvY2tldC5DTE9TSU5HOiByZXR1cm4gJ2Nsb3NpbmcnXG4gICAgICBjYXNlIFdlYlNvY2tldC5DTE9TRUQ6IHJldHVybiAnZGlzY29ubmVjdGVkJ1xuICAgICAgZGVmYXVsdDogcmV0dXJuICd1bmtub3duJ1xuICAgIH1cbiAgfVxufSJdLCJuYW1lcyI6WyJXb3JrZmxvd1dlYlNvY2tldENsaWVudCIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsIndzIiwicmVjb25uZWN0QXR0ZW1wdHMiLCJyZWNvbm5lY3RUaW1lciIsInBpbmdUaW1lciIsImlzQ29ubmVjdGluZyIsInNob3VsZFJlY29ubmVjdCIsInJlY29ubmVjdEludGVydmFsIiwibWF4UmVjb25uZWN0QXR0ZW1wdHMiLCJjb25uZWN0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZWFkeVN0YXRlIiwiV2ViU29ja2V0IiwiT1BFTiIsInByb3RvY29sIiwid2luZG93IiwibG9jYXRpb24iLCJ3c1VybCIsImhvc3QiLCJ3b3JrZmxvd0lkIiwidG9rZW4iLCJvbm9wZW4iLCJsb2dnZXIiLCJpbmZvIiwiY29tcG9uZW50Iiwic3RhcnRQaW5nVGltZXIiLCJvbkNvbm5lY3QiLCJvbm1lc3NhZ2UiLCJldmVudCIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwiaGFuZGxlTWVzc2FnZSIsImVycm9yIiwiY29uc29sZSIsIm9uY2xvc2UiLCJjb2RlIiwicmVhc29uIiwic3RvcFBpbmdUaW1lciIsIm9uRGlzY29ubmVjdCIsInNjaGVkdWxlUmVjb25uZWN0Iiwib25lcnJvciIsIm9uRXJyb3IiLCJDT05ORUNUSU5HIiwiRXJyb3IiLCJkaXNjb25uZWN0IiwiY2xlYXJSZWNvbm5lY3RUaW1lciIsImNsb3NlIiwic2VuZE1lc3NhZ2UiLCJzZW5kIiwic3RyaW5naWZ5Iiwid2FybiIsInNlbmRVc2VyUmVzcG9uc2UiLCJhZ2VudElkIiwicmVzcG9uc2UiLCJ0eXBlIiwic2VuZFdvcmtmbG93Q29udHJvbCIsImFjdGlvbiIsInJlcXVlc3RTdGF0dXMiLCJvbk1lc3NhZ2UiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJkZWxheSIsIk1hdGgiLCJtaW4iLCJwb3ciLCJhdHRlbXB0IiwiZGVsYXlNcyIsInNldFRpbWVvdXQiLCJjYXRjaCIsImNsZWFyVGltZW91dCIsImlzQ29ubmVjdGVkIiwiY29ubmVjdGlvblN0YXRlIiwiQ0xPU0lORyIsIkNMT1NFRCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./src/lib/websocket-client.ts\n");

/***/ })

};
;